<HTML>
<HEAD>
   <TITLE>stability of wavefunctions</TITLE>
</HEAD>


<BODY bgcolor="#FFFFFF">

<CENTER>
<H2>Stability of Wavefunctions</H2> 
</CENTER>
<HR>
Wavefunctions generated by SCF calculations can be unstable in various ways:<BR><BR>

1) The lowest energy wavefunction is a <FONT COLOR="#0000FF">singlet biradical</FONT> instead 
of a closed shell singlet. A proper description of singlet biradicals at the Hartree-Fock 
level requires an UHF wavefunction. This is a typical case for an 
<FONT COLOR="#0000FF">RHF/UHF instability</FONT><BR><BR>

2) A triplet state is energetically more favorable than the lowest lying singlet state.
This will also lead to an <FONT COLOR="#0000FF">RHF/UHF instability</FONT><BR><BR>

3) There is more than one solution to the SCF equations for the system and the calculation
converges to a less favorable one. This will lead to either a <FONT COLOR="#0000FF">RHF/RHF</FONT>
or <FONT COLOR="#0000FF">UHF/UHF instability</FONT><BR><BR>

The various cases of wavefunction instability will be demonstrated using two
small model systems, O<SUB>2</SUB> and O<SUB>3</SUB>.<BR><BR>

<B>1) molecular oxygen  O<SUB>2</SUB></B><BR>
Let us first calculate the Hartree-Fock energy for singlet dioxygen at the RHF/STO-5G level 
of theory (using the geometry optimized at this level) with the following input file:<BR><BR>

<TABLE BORDER=0>
<TR><TD>

<FONT COLOR="#0000FF">
<PRE>
#RHF/STO-5G scf=(tight,qc)

RHF/STO-3G singlet O2

0 1
O1
O2  1  r1

r1=1.22220
</PRE>
</FONT>

<TD>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
<TD>O=O</TD>
</TABLE><BR>

This yields the following result:<BR><BR>

<FONT COLOR="#0000FF">
<PRE>
 SCF Done:  E(RHF) =  -148.886061396     a.u. after    4 cycles
            Convg  =    0.1803D-07                    16 Fock formations.
              S**2 =  0.0000                  -V/T =  2.0033

 **********************************************************************

            Population analysis using the SCF density.

 **********************************************************************

 Orbital symmetries:
       Occupied  (SGG) (SGU) (SGG) (SGU) (PIU) (SGG) (PIU) (PIG)
       Virtual   (PIG) (SGU)
 Unable to determine electronic state:  partially filled degenerate orbitals.
</PRE>
</FONT>

Subsequent analysis of this wavefunction with the keyword combination

<FONT COLOR="#0000FF">
stable guess=read
</FONT>

reads in the converged wavefunction and, by analysis of a number of
excitations starting from the HF-solution, yields the following 
additional information:<BR><BR>

<FONT COLOR="#0000FF">
<PRE>
 ***********************************************************************
 Stability analysis using <AA,BB:AA,BB> singles matrix:
 ***********************************************************************

 Eigenvectors of the stability matrix:

 Excited state symmetry could not be determined.
 Eigenvector   1:   Triplet-?Sym  Eigenvalue=-0.2009390
       7 ->  9         0.70536

 Excited state symmetry could not be determined.
 Eigenvector   2:   Triplet-?Sym  Eigenvalue=-0.1078684
       8 ->  9         0.70711

 Excited state symmetry could not be determined.
 Eigenvector   3:   Singlet-?Sym  Eigenvalue= 0.0000000
       8 ->  9         0.70711

 Excited state symmetry could not be determined.
 Eigenvector   4:   Triplet-?Sym  Eigenvalue= 0.0667651
       6 ->  9         0.65552
       7 -> 10         0.26170

 Excited state symmetry could not be determined.
 Eigenvector   5:   Triplet-?Sym  Eigenvalue= 0.2052332
       5 ->  9         0.70711

 Excited state symmetry could not be determined.
 Eigenvector   6:   Singlet-?Sym  Eigenvalue= 0.2170234
       6 ->  9         0.66826
       7 -> 10         0.22006
 The wavefunction has an RHF -> UHF instability.
</PRE>
</FONT><BR>

This analysis points to a triplet state wavefunction lower in energy than the current
singlet state. The actual triplet wavefunction is, however, not calculated explicitly.
In order to find the optimized triplet wavefunction, a second calculation must be performed.
Using the same geometry as before (RHF/STO-5G), the calculation is performed in one
run together with the stability analysis of the triplet wavefunction:<BR><BR>

<FONT COLOR="#0000FF">
<PRE>
#UHF/STO-5G stable scf=(tight,qc)

UHF/STO-3G triplet O2

0 3
O1
O2  1  r1

r1=1.22220
</PRE>
</FONT><BR>

The total energy of  -148.968737 Hartree obtained in this UHF/STO-5G calculation 
is lower by 217 kJ/mol than the one obtained for the singlet state at the RHF/STO-3G level!
Despite this large improvement, the stability analysis reveals one more problem
with the wavefunction:<BR><BR>

<FONT COLOR="#0000FF">
<PRE>
 The wavefunction has an internal instability.
</PRE>
</FONT><BR>

From the additional data given by the stability analysis it appears that the triplet
state optimized with the default guess does NOT converge to the triplet state of 
correct symmetry (and lowest energy). This can be solved either by an appropriate 
<A HREF="hf2.html">manipulation of the initial guess</A>
as discussed before or with the keyword <FONT COLOR="#0000FF">guess=mix</FONT> originally
designed to provide an asymmetric initial guess for calculations on singlet biradicals.
In either case, a new triplet state of different symmetry is obtained at somewhat lower
total energy of -148.9720434, 225.7 kJ/mol below the singlet state. Stability analysis
of this wavefunction now confirms that:<BR><BR>

<FONT COLOR="#0000FF">
<PRE>
 The wavefunction is stable under the perturbations considered.
</PRE>
</FONT><BR><BR>

The same result can be obtained by running the stability calculation with <FONT COLOR="#0000FF">stable=opt</FONT>.
Under these latter conditions the constraints imposed upon the wavefunction are reduced incrementally
until a stable wavefunction is obtained. The key feature of the most stable wavefunction obtained for
triplet oxygen by either <FONT COLOR="#0000FF">stable=opt</FONT> or <FONT COLOR="#0000FF">guess=mix</FONT>
is the reduced symmetry of the two highest lying orbitals.<BR><BR>


<B>2) ozone  O<SUB>3</SUB></B><BR>
Calculation of the singlet state RHF/6-31G(d) energy of ozone at its experimental geometry with the following
input<BR><BR>

<FONT COLOR="#0000FF">
<PRE>
#RHF/6-31G(d) stable scf=(tight,qc)

RHF/STO-3G singlet O3

0 1
O1
O2  1  1.2227
O3  1  1.2227  2  114.0451
</PRE>
</FONT><BR>

 and subsequent stability analysis yields the following result:<BR> 

<FONT COLOR="#0000FF">
<PRE>
 SCF Done:  E(RHF) =  -224.258537798     a.u. after    8 cycles
 The wavefunction has an RHF -> UHF instability.
</PRE>
</FONT><BR>

As we have seen in the first example of O<SUB>2</SUB>, this can immediately be solved by
performing an UHF/6-31G(d) calculation on the corresponding triplet state of ozone. In contrast
to the first example, however, the total energy of the triplet state obtained in this way is higher
than that of the singlet state obtained initially. Stability analysis also reveals an internal
instability as encountered before due to convergence to a state of wrong symmetry:<BR>

<FONT COLOR="#0000FF">
<PRE>
 SCF Done:  E(UHF) =  -224.226611298     a.u. after   10 cycles
 The wavefunction has an internal instability.
</PRE>
</FONT><BR>

In this situation one must consider the possibility of a singlet diradical which requires
the use of an UHF wavefunction even for a singlet state. Generating a broken symmetry
guess for the singlet wavefunction with <FONT COLOR="#0000FF">guess=mix</FONT> currently 
appears to work well only with the INDO guess:<BR>

<FONT COLOR="#0000FF">
<PRE>
#UHF/6-31G(d) guess=(INDO,mix) stable scf=(tight,qc)

UHF/STO-3G singlet O3

0 1
O1
O2  1  1.2227
O3  1  1.2227  2  114.0451
</PRE>
</FONT><BR>

As a result a biradical singlet state is obtained that is 180.3 kJ/mol more favorable than the
singlet state described by the RHF wavefunction before. In this last case the stability analysis
detects no further problems with the wavefunction:<BR>

<FONT COLOR="#0000FF">
<PRE>
SCF Done:  E(UHF) =  -224.327207261     a.u. after   10 cycles
The wavefunction is stable under the perturbations considered.
</PRE>
</FONT><BR>

Please observe that a broken symmetry UHF singlet wavefunction is only obtained
using the <FONT COLOR="#0000FF">guess=mix</FONT> keyword. If this is not used, the
initial guess is chosen such that the SCF calculation converges to the RHF wavefunction even
with the UHF Ansatz. An alternative strategy to obtain the energetically most favorable
singlet wavefunction for ozone involves the use of <FONT COLOR="#0000FF">stable=opt</FONT>.
<BR><BR>

<hr>
<PRE>
<TT>last changes: 22.11.2004, HZ
questions & comments to: <A HREF="mailto:zipse@cup.uni-muenchen.de">zipse@cup.uni-muenchen.de</A>
</TT>
</PRE> 


</BODY>
</HTML>
