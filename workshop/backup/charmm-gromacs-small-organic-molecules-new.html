<!docTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"> 
<html>

<head>
<title>GROMACS: MD Simulation of a Protein-Ligand Complex</title>
</head>

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>

<center><h1>GROMACS: MD Simulation of a Protein-Ligand Complex</h1></center>
<br>

<p>
This GROMACS tutorial mostly follows the Protein-Ligand Complex Tutorial at 
<a href="http://www.mdtutorials.com/gmx/" target="_new">GROMACS Tutorials</a>
by Justin A. Lemkul, Ph.D. with two important differences:

<ul>
<li> The CHARMM force field is used for both the protein and the ligand.
<li> The GROMACS ligand topology and parameter files are obtained from the <a href="https://cgenff.paramchem.org">CGenFF</a> server.
</ul>

There are several other important minor differences which will become obvious as the tutoral proceeds.

</p>

<h1>Directory organization</h1>
<p>
The workflow for setting up, running, and analysing a simulation
consists of multiple and rather different steps. It is useful to
perform these different steps in separate directories in order to
avoid overwriting files or using wrong files.
</p>
<p>
For this tutorial the suggested directory layout is the following:
<pre>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- charmm36-mar2019/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. coord/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2. protein/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3. ligand/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4. top/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5. solvation/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6. emin/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7. posres/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8. equilibration1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9. equilibration2
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10. production/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11. analysis/
</pre>
</p>
<p>
The following is a short description of the directories:
</p>
<ul>
<li>charmm36-mar2019.ff/ - CHARMM force field parameters</li>
<li>coord/ - PDB and coordinate files</li>
<li>ligand/ - CHARMM parameter and coordinate files in GROMACS format for the ligand</li>
<li>top/ - topology files</li>
<li>solvation/ - add solvent and ions</li>
<li>emin/ - energy minimization</li>
<li>posres/ - position restraints on the heavy protein atoms, allowing the solvent to equilibrate around the protein without disturbing the protein structure</li>
<li>equilibration1/ - perform an NVT equilibration using GROMACS</li>
<li>equilibration2/ - perform an NPT equilibration using GROMACS</li>
<li>production/ - perform a Molecular Dynamics simulation using GROMACS
<li>analysis/ - different ways of analyzing the trajectory are described</li>
</ul>


<h1>Workflow</h1>
<p>
The workflow for this exercise is such that each step is carried out <b>in order</b> and inside the appropriate directory.

Each subdirectory depends on a specific task that is to be carried out, and is worked through in sequence.  

If a required file is needed in a subdirectory for use with the GROMACS command, copy that file to the subdirectory first.
</p>

<h1>Building the Simulation System</h1>
<p>
The problem with a protein-ligand system is that the force field parameters, as well as other parameters, must be determined for both the protein and the small
organic molecule that is within the protein.  Parameters for the protein component are well-known and usually do not present any difficulty, 
but parameters for the small organic molecule must be obtained from a different force field. 

The following steps provide one way to obtain parameters for the small molecule organic ligand when the CHARMM force field is used.
</p>

<h2>The Coordinates</h2>
<p>
Separate the original pdb file into two pdb files, one for the protein and one for the small-molecule ligand, jz4.
<pre>
protein.pdb
jz4.pdb
</pre>
</p>

<h2>The Protein</h2>
      <ul>
      <li>Generate a GROMACS topology (<b>topol.top</b>) for the protein, without the ligand
      <p>
      <font color="#008000"><b>gmx pdb2gmx -f protein.pdb -ff charmm36-mar2019 -water tip3p -ignh -o conf.pdb -nochargegrp</b></font>
      </p>
      </ul>

<h2>The Ligand</h2>
<ul>
      </li>
      <li>Convert the jz4.pdb file to a jz4.mol2 using <a href="http://openbabel.org/wiki/Babel">Babel</a>.</li>
      <p>
      <font color="#008000"><b>babel -i pdb jz4.pdb -o mol2 jz4.mol2</b></font>
      </p>
      <li>
      <p>
      The jz4.mol2 is then submitted to the <a href="https://cgenff.paramchem.org">CGenFF</a> server.`
      </p>
      <p>
      Subsequently, the file <font color="#008000"><b>jz4.str</b></font> is now available for download, and can be used for both CHARMM and GROMACS.
      </p>
      <p>
      A separate python file, <b>cgenff_charmm2gmx_py2.py</b>, is required for converting a the CHARMM jz4.str file into GROMACS input files.
      </p>
    <p>
    The command:
    <p>
    <font color="#008000"><b>cgenff_charmm2gmx_py2.py jz4 jz4.mol2 jz4.str charmm36-mar2019.ff</b></font>
    yields four files:
    </p>
    jz4.itp - GROMACS topology file
    jz4.prm - GROMACS parameter file
    jz4_ini.pdb - PDB file for the initial coordinates of the jz4 ligand
    jz4.top 
    </pre>
    Three of the files, jz4.itp, jz4.prm, and jz4_ini.pdb  are required GROMACS files for the ligand component of the protein-ligand complex.
    The file, jz4.top, is a GROMACS prototype topology file which indicates where to place specific files for the protein and jz4 ligand.  It is not used in this simulation,
   and should not be confused with the required topol.top file, the system topolgy file.
    </p>
</li>
</ul>

<h2>The Protein-Ligand Complex</h2>
       <ol>
      <p>
      <li>Merge the protein and ligand coordinates, by inserting the ATOM lines from
	 the jz4_ini.pdb file into the protein.pdb file, right after the last line for the protein.
	 Atoms will be automatically renumbered in the next step.
       </p>
      </li>
      
      <p>
      <li>Edit the topol.top file generated for the protein to include the required files for the ligand.
      </p>

  </ol>

<h2>Define the Unit Cell and Add Solvent</h2>
<p>
      <font color="#008000"><b>gmx editconf -f protein.pdb -o boxed.pdb -c -d 1.0 -bt dodecahedron</b></font>
</p>
<p>
      <font color="#008000"><b>gmx solvate  -cs -cp boxed.pdb -o solvated.pdb -p topol.top</b></font>
</p>

<h2>Adding Ions</h2> 
<p>
The system is now solvated but contains a charged protein. The output of pdb2gmx told us that the protein has a net charge of +6<i>e</i>
(based on its amino acid composition). If you missed this information in the pdb2gmx output, look at the last line of your <code>[ atoms ]</code> 
directive in topol.top which should read (in part) &quot;qtot 6.&quot; It is necessary to add ions to obtain a neutral system in order to perform Molecular Dynamics
with particle mesh ewald, for calculation of long-range electrostatic interactions.
</p>
<p>
Use grompp to assemble a .tpr file, using any .mdp file, for example, em.mdp.  
</p>
<p>
      <font color="#008000"><b>gmx grompp  -f em.mdp -c solvated.pdb -p topol.top -o ions.tpr</b></font>
</p>
<p>
The ions.tpr files is then passed to genion:
</p>
<p>
      <font color="#008000"><b>gmx genion  -s ions.tpr -o solvated_ions.pdb -p topol.top -pname NA -nname CL -conc 0.1</b></font>
</p>
<p>
The specified atom names of ions are always the elemental symbol in all capital letters, along with the <code>[ moleculetype ]</code>. 
Residue names may or may not append the sign of the charge (+/-). Refer to ions.itp for proper nomenclature if you encounter difficulties.
</p>

<p>
The  <code[ molecules ]</code> directive should now look like:
</p>
<p>
<pre>
<font color="#008000"><b>
[ molecules ]
; Compound        #mols
Protein_chain_A     1
JZ4                 1
SOL             13322
NA                 26
CL                 32
</pre>
</b>
</font>
</p>

<h1>Energy Minimization (emin)</h1>
<p>
Now that the system is assembled, create the binary input using grompp and em.mdp as the input parameter file:
</p>
<p>
<font color="#008000"><b>gmx grompp -f em.mdp -c solvated_ions.pdb -p topol.top -o em.tpr</b></font>
</p>
<p>
Note that in the em.mdp file, the command: <font color="#008000"><b>energygrps = Protein JZ4</b></font> is set, since it may be of interest later to examine the various
components of the nonbonded interactions between your protein and ligand. This is a good practice in case anything goes wrong.
</p>

<p>
Make sure the topol.top file is updated each time when running
genbox and solvate, or else you will get lots of nasty error messages
(&quot;number of coordinates in coordinate file does not match topology,&quot; etc).
</p>

<p>
We are now ready to invoke mdrun to carry out minimization:
</p>
<p>
<font color="#008000"><b>gmx mdrun -v -deffnm em</b></font>
</p>
<p>
The system should converge relatively quickly:
</p>
<font color="#008000"><b>
<pre>
Steepest Descents converged to Fmax &lt; 1000 in 178 steps
Potential Energy  = -5.0933919e+05
Maximum force     =  9.1495343e+02 on atom 1266
Norm of force     =  5.1248310e+01
</pre>
</b></font>

<p>
It is possible to monitor various components of the potential energy using the energy module. The em.edr file contains all of the energy 
terms that GROMACS collects during energy minimization, and any .edr file can be analyzed  using the GROMACS energy module:
</p>
<p>
<font color="#008000"><b>gmx energy -f em.edr -o potential.xvg</b></font>
</p>
<p>
At the prompt, type "10 0" to select Potential (10); zero (0) terminates input. You will be shown the average of Epot, and a file called "potential.xvg" will be written.
To plot this data, use the Xmgrace plotting tool. The resulting plot should look something like this, demonstrating the nice, steady convergence of Epot:
<p>
<center>
<img src="files/Epot_EM_SD.jpg" width="706" height="540" name="Energy Minimization" alt="./Epot_EM_SD.jpg">
</center>

<h1>Equilibration1 (NVT)</h1>
<p>Now that the system is at an energy minimum where bad contacts between atoms have been reduced, it is now possible to begin dynamics.</p>
<p>
Equilibrating our protein-ligand complex will be much like
equilibrating any other system containing a protein in water. 
However, there are a few special considerations, in this case:
</p>
<ol>
<li/>
<p style="margin-bottom: 0in">Applying restraints to the ligand</p>
<li/>
<p>Treatment of temperature coupling groups</p>
</ol>

<h2>Restraining the Ligand</h2>
<p>
The CGenFF server did not generate a separate restraint file for the ligand, analogous to the posre.itp for the protein, but GROMACS provides the means to do so with the genrestr
module. Run the genrestr command on the jz4_ini.pdb file that we obtained from CGenFF:
</p>
<p>
<font color="#008000"><b>gmx genrestr -f jz4_ini.pdb -o posre_jz4.itp -fc 1000 1000 1000></b></font>
</p>
<p>
Now, this information must be included in the topology and can be performed in several ways.
If we simply want to restrain the ligand whenever the protein is also restrained, add the following lines to the topology in the location
indicated:
</p>
<font color="#008000"><b>
<pre>
; Include Position restraint file
#ifdef POSRES
#include &quot;posre.itp&quot;
#endif

; Include ligand topology
#include &quot;jz4.itp&quot;

; Ligand position restraints
#ifdef POSRES
#include &quot;posre_jz4.itp&quot;
#endif

; Include water topology
# &quot;charmm36-mar2019/tip3p.itp&quot;
</pre>
</b></font>

<p>
Location matters! The line for posre_jz4.itp must be inserted in the topology as indicated. The parameters within jz4.itp define a 
<code>[ moleculetype ]</code> directive for our ligand. The moleculetype ends
with the inclusion of the water topology (tip3p.itp). Placing the call to posre_jz4.itp anywhere else will attempt to apply the position
restraint parameters to the wrong moleculetype.
</p>
<p>
If a bit more control during equilibration is desired, i.e.
restraining the protein and ligand independently, 
the inclusion of the ligand position restraint file in a
different #ifdef block could be included in the following manner:
</p>
<font color="#008000"><b>
<pre>
; Include Position restraint file
#ifdef POSRES
#include &quot;posre.itp&quot;
#endif

; Include ligand topology
#include &quot;jz4.itp&quot;

; Ligand position restraints
#ifdef POSRES_LIG
#include &quot;posre_jz4.itp&quot;
#endif

; Include water topology
#include &quot;charmm36-mar2019/tip3p.itp&quot;
</pre>
</b></font>
<p>
In the latter case, in order to restrain <b>both</b> the protein and
the ligand simultaneously, the command
<b>define = -DPOSRES -DPOSRES_LIG</b> would have to be specificed in the .mdp file. 
</p>
<p>
There are manny ways to specify the system.
These examples are meant only to
illustrate the flexibility GROMACS provides. For a standard
equilibration procedure, restraining the protein and ligand
simultaneously is probably sufficient. Your own needs may vary.</p>
</p>

<h2>Thermostats</h2>
<p>
Proper control of temperature coupling is a sensitive issue.
Coupling every moleculetype to its own thermostat group is a bad
idea. For the following command:
</p>
<pre class="western" style="margin-bottom: 0.2in">tc_grps = Protein JZ4 SOL CL</pre>
<p>
the system will probably blow up, since the temperature coupling
algorithms are not stable enough to control the fluctuations in
kinetic energy that groups with a few atoms (i.e., JZ4 and CL) will
produce. <font color="#ff0000"><b>Do not couple every single species
in your system separately.</b></font></p>

<p>
The typical approach is to set <code class="western">tc_grps =
Protein Non-Protein</code> and carry on. Unfortunately, the
&quot;Non-Protein&quot; group also encompasses JZ4. Since JZ4 and the
protein are physically linked very tightly, it is best to consider
them as one single entity. 
</p>
<p>
That is, JZ4 becomes part of the protein,
for the purposes of temperature coupling. In the same way, the few
Cl- ions we inserted become part of the solvent. To do this, 
a special index group is needed that merges the protein and JZ4. This is accomplished
with the make_ndx module, supplying any coordinate file of the
complete system. In this case, em.gro is used, the output for the minimized
structure of the system:
</p>
<pre>
<font color="#008000"><b>
gmx make_ndx -f em.gro -o index.ndx
...
  0 System              : 33037 atoms
  1 Protein             :  1693 atoms
  2 Protein-H           :  1301 atoms
  3 C-alpha             :   163 atoms
  4 Backbone            :   489 atoms
  5 MainChain           :   653 atoms
  6 MainChain+Cb        :   805 atoms
  7 MainChain+H         :   815 atoms
  8 SideChain           :   878 atoms
  9 SideChain-H         :   648 atoms
 10 Prot-Masses         :  1693 atoms
 11 non-Protein         : 31344 atoms
 12 Other               :    15 atoms
 13 JZ4                 :    15 atoms
 14 CL                  :     6 atoms
 15 Water               : 31323 atoms
 16 SOL                 : 31323 atoms
 17 non-Water           :  1714 atoms
 18 Ion                 :     6 atoms
 19 JZ4                 :    15 atoms
 20 CL                  :     6 atoms
 21 Water_and_ions      : 31329 atoms 
</pre>
</b></font>
<p>
Merge the &quot;Protein&quot; and &quot;JZ4&quot; groups with the
following, where &quot;&gt;&quot; indicates the make_ndx prompt:</p>
<pre>
<font color="#008000"><b>
&gt; 1 | 13
&gt; q
</pre>
</b></font>
<p>
The command, <font color="#008000"><b>tc_grps = Protein_JZ4 Water_and_ions</b></font>, can be set  to achieve the  desired &quot;Protein Non-Protein&quot; effect.</p>

Proceed with <b>NVT</b> equilibration using the <b>nvt.mdp</b> file:
</p>

<font color="#008000"><b>
<pre>
gmx grompp -f nvt.mdp -c em.gro -p topol.top -n index.ndx -o nvt.tpr

gmx mdrun -deffnm nvt
</pre>
</b></font>

<p>
A full explanation of the parameters used can be found in the GROMACS manual, in addition to the comments provided. Take note of a few parameters in the .mdp file:
<ul>
<li>gen_vel = yes: Initiates velocity generation. Using different 
random seeds (gen_seed) gives different initial velocities, and thus multiple (different) simulations can be conducted from the same starting structure.
<li>tcoupl = V-rescale: The velocity rescaling thermostat is an improvement upon the Berendsen weak coupling method, which did not reproduce a correct kinetic ensemble.
<li>pcoupl = no: Pressure coupling is not applied. 
</ul>
The temperature progression, again using energy, can be analyzed:
</p>
<pre>
<font color="#008000"><b>
gmx energy -f nvt.edr
</pre>
</b></font>
<p>
Type "15 0" at the prompt to select the temperature of the system and exit. The resulting plot should look something like the following:

</p>
<center>
<img src="files/Temp_NVT.jpg" name="NVT Simulation" width="673" height="542" alt="Temp_NVT.jpg">
</center>
From the plot, it is clear that the temperature of the system quickly reaches the target value (300 K), and remains stable over the remainder of the equilibration. 
For this system, a shorter equilibration period (on the order of 50 ps) may have been adequate.

<h2>Equilibration2 (NPT)</h2>
<p>
Now that the <b>NVT</b> simulation is complete, one can proceed to an <b>NPT</b> simulation with the <b>npt.mdp</b> file:
</p>
<p>
The previous step, <b>NVT</b> equilibration, stabilized the temperature of the system. Prior to data collection, we must also stabilize the pressure (and thus also the density) of the system. 
Equilibration of pressure is conducted under an <b>NPT</b> ensemble, wherein the Number of particles(N), Pressure(P), and Temperature(T) are all constant. 
The ensemble is also called the "isothermal-isobaric" ensemble, and most closely resembles experimental conditions.
</p>
<p>
grompp and mdrun are used just as in the <b>NVT</b> equilibration. Note that we are now including the -t flag to include the checkpoint file from the <b>NVT</b> equilibration; 
This file contains all the necessary state variables to continue th simulation. To conserve the velocities produced during <b>NVT</b>, this file must be included. 
The coordinate file (-c) is the final output of the <b>NVT</b> equilibration.
</p>

<p>
The npt.mdp file used for an <b>NPT</b> equilibration is not drastically different from the parameter file used for <b>NVT</b> equilibration. 
Note the addition of the pressure coupling section, using the Parrinello-Rahman barostat.
</p>

<p>
Other changes inlude:
<p>
continuation = yes: continue the simulation from the NVT equilibration phase
<br>
gen_vel = no: velocities are read from the trajectory (see below) 
</p>

<font color="#008000"><b>
<pre>
gmx grompp -f npt.mdp -c nvt.gro -t nvt.cpt -p topol.top -n index.ndx -o npt.tpr

gmx mdrun -deffnm npt
</pre>
</b></font>

<h3>Pressure</h3>
<p>
The pressure progression can be analyzed again using energy:
<font color="#008000"><b>
<pre>
gmx energy -f npt.edr -o pressure.xvg
</pre>
</b></font>
Type "16 0" at the prompt to select the pressure of the system and exit. The resulting plot should look something like the following:
<center>
<img src="files/Pressure_NPT.jpg" name="NPT Simulation" width="703" height="531" alt="Pressure_NPT.jpg">
</center>
The pressure value fluctuates widely over the course of the 100-ps equilibration phase, but this behavior is not unexpected. 
The running average of these data are plotted as the red line in the plot. Over the course of the equilibration, the average value of the pressure is 1.05 bar.
</p>

<h3>Density</h3>
<p>
Let's take a look at density as well, this time using energy and entering "22 0" at the prompt.
<font color="#008000"><b>
<pre>
gmx energy -f npt.edr -o density.xvg
</pre>
</b></font>
<center>
<img src="files/Density_NPT.jpg" width="710" height="539" name="NPT Simulation" alt="Density_NPT.jpg">
</center>
As with the pressure, the running average of the density is also plotted in red. The average value over the course of 100 ps is 998.3 kg m<sup>-3</sup>, 
close to the experimental value of 1000 kg m<sup>-3</sup>,  and the expected density of the TIP3P model of 1008 kg m<sup>-3</sup>. 
The density values are very stable over time, indicating that the system is well-equilibrated now with respect to pressure and density.
Initially, it may appear that calculated density values do not match results. 
Pressure-related terms are slow to converge, and thus may be necessary to run <i>NPT</i> equilibration slightly longer than is specified here.
</p>

<h1>Production</h1>
<p>
Upon completion of the two equilibration phases, the system is now well-equilibrated at the desired temperature and pressure. We are now
ready to release the position restraints and run production MD for data collection. The process will make use of the checkpoint 
file, which, in this case, now contains preserve pressure coupling information to grompp. 
</p>
<p>
A 1-ns MD simulation will be run, the commands for which can be found in the <b>md.mdp</b> script file.
</p>
<font color="#008000"><b>
<pre>
gmx grompp -f md.mdp -c npt.gro -t npt.cpt -p topol.top -n index.ndx -o md_0_1.tpr
</pre>
</b></font>

<h1>Analysis</h1>

<h2>trjconv</h2> 
<p>
trjconv is used as a post-processing tool to strip out coordinates, correct for periodicity, or manually alter the trajectory 
(time units, frame frequency, etc). trjconv can be used account for any periodicity in the system. The protein will diffuse through 
the unit cell, and may appear to "jump" across to the other side of the box. To account for such actions, issue the following:
</p>
<font color="#008000"><b>
<pre>
gmx trjconv -s md_0_1.tpr -f md_0_1.xtc -o md_0_1_noPBC.xtc -pbc mol -ur compact
</pre>
</b></font>
<p>
Select 0 ("System") for output. All analyses will be conducted on this "corrected" trajectory. 
</p>
<p>
It is important to remember that GROMACS always works internally with an equivalent triclinic unit cell.
To verify that the  solvated molecule appears correctly in the octahedral simulation cell, it is necessary to transform 
the coordinates using the command:
</p>
<font color="#008000"><b>
<pre>
gmx trjconv -s topol.tpr -f solvated_ions.pdb -o compact.pdb -ur compact -pbc mol
</pre>
</b></font>
<p>
The types of data that are important for a simulation is a question to ask before running the simulation, 
so it is necessary to have ideas about the types of data you will want to collect. For this tutorial, a few basic tools will be introduced.
</p>

<h2>Protein-Ligand Hydrogen Bonding Interactions</h2>
<p>
For a ligand like JZ4, hydrogen bonding is possible, so you might use gmx hbond to determine if any occurred. 
</p>
<font color="#008000"><b>
<pre>
gmx hbond -f npt.trr -s npt.tpr -num hbond.xvg
</pre>
</b></font>
<p>
Is hydrogen bonding important?
</p>
<h2>Protein-Ligand Interactions: van der Waals and Electrostatic Energies</h2>
<p>
The use of energygrps in the md.mdp file will allow an examination of the various components of the nonbonded potential between JZ4 and the protein. 
</p>
<font color="#008000"><b>
<pre>
gmx energy -f md.edr -o vdw.xvg

gmx energy -f md.edr -o  es.xvg
</pre>
</b></font>

<p>
Do electrostatic interactions or van der Waals (hydrophobic) interactions dominate the association between these two species?
</p>

<h2>RMSD</h2> 
<p>
To look at structural stability, GROMACS has a built-in utility for RMSD calculations called rms. To use rms, issue this command:
</p>

<font color="#008000"><b>
<pre>
gmx rms -s md_0_1.tpr -f md_0_1_noPBC.xtc -o rmsd.xvg -tu ns
</pre>
</b></font>
<p>
Choose 4 ("Backbone") for both the least squares fit and the group for RMSD calculation. The -tu flag will output the results in terms of ns, 
even though the trajectory was written in ps. This is done for clarity of the output (especially if you have a long simulation - 1e+05 ps does not look as nice as 100 ns). 
The output plot will show the RMSD relative to the structure present in the minimized, equilibrated system:
<center>
<img src="files/rmsd_0_1.jpg" name="RMSD Graph of Backbone" width="690" height="533" alt="rmsd_0_1.jpg">
</center>
</p>

<h2>RMSF</h2> 
<p>
RMSF, the root mean square fluctuation, is a measurement similar to RMSD. Instead of indicating positional differences between entire structures over time, RMSF is a calculation 
of individual residue flexibility and provides information of how much a particular residue moves (fluctuates) during a simulation. 
RMSF per residue is typically plotted vs. residue number, and can indicate structurally which amino acids in a protein contribute the most to a molecular motion.
</p>

<font color="#008000"><b>
<pre>
gmx rmsf -s md_0_1.tpr -f md_0_1_noPBC.xtc -o rmsf.xvg 
</pre>
</b></font>
<p>
For example, Choose Option 4 ("Backbone") for an RMSF calculation. 
The output plot will show the RMSF values or fluctuations for the atoms in each residue.
<center>
<img src="files/rmsf.jpg" name="RMSD Graph of Backbone" width="690" height="533" alt="rmsd_0_1.jpg">
</center>
</p>

<h2>Radius of Gyration, <i>R<sub>g</sub></i></h2> 
<p>
The radius of gyration of a protein is a measure of its compactness. If a protein is stably folded, it will likely maintain a relatively steady value of <i>R<sub>g</sub></i>.
If a protein unfolds, its <i>R<sub>g</sub></i> will change over time. An analysis of the radius of gyration for protein-ligand simulation can be performed:
</p>
<font color="#008000"><b>
<pre>
gmx gyrate -s md_0_1.tpr -f md_0_1_noPBC.xtc -o gyrate.xvg
</pre>
</b></font>
<center>
<img src="files/Rg_0_1.jpg" width="708" height="544">
</center>
<p>
The figure above shows that the <i>R<sub>g</sub></i> is reasonably invariant, indicating that the protein remains very stable, in its compact (folded) form over the course of 1 ns at 300 K. 
This result is not unexpected, but illustrates an advanced capacity of GROMACS analysis that comes built-in.
</p>
<p class="footer" align="center">
  Department of Chemistry<br>
  The University of Connecticut<br>
  55 North Eagleville Road, Unit 3060<br>
  Storrs, CT 06269-3060<br>
  PHONE: 646-996-4145<br>
  e-mail: <a href="mailto:angelo.rossi@uconn.edu">angelo.rossi@uconn.edu</a><br>
  </p>
</div>
<!-- div id="LayerMail" style="position:absolute; left:251px; top:156px; width:26px; z-index:5" class="icondiv">
<a href="feedback.htm"><img src="/home/rossiar/athletics/assets/mailv.gif" width="26" height="26" alt="Contact Us"></a></div -->
</body>
</html>
