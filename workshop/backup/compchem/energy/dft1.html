<HTML>
<HEAD>
   <TITLE>DFT</TITLE>
</HEAD>


<BODY bgcolor="#FFFFFF">

<CENTER>
<H2>Density Functional Theory</H2> 
</CENTER>
<HR>
In <FONT COLOR="#0000FF">density functional theory (DFT)</FONT> the energy of a system 
is given as a sum of six components:<BR><BR>

E<SUB>DFT</SUB> = E<SUB>NN</SUB> + E<SUB>T</SUB> + E<SUB>v</SUB> + E<SUB>coul</SUB> + 
E<SUB>exch</SUB> + E<SUB>corr</SUB> <BR><BR>

The definitions for the nuclear-nuclear repulsion  E<SUB>NN</SUB>, the  nuclear-electron 
attraction E<SUB>v</SUB>, and the classical electron-electron Coulomb repulsion
E<SUB>coul</SUB> energies are the same as those used in Hartree-Fock theory. The
kinetic energy of the electrons E<SUB>T</SUB> as well as the non-classical
electron-electron exchange energies E<SUB>exch</SUB> are, however, different from those
used in Hartree-Fock theory. The last term E<SUB>corr</SUB> describes the correlated
movement of electrons of different spin and is not accounted for in Hartree-Fock theory.
Due to these differences, the exchange energies calculated exactly in Hartree-Fock theory
cannot be used in density functional theory.<BR><BR>

Various approaches exist to calculate the exchange and correlation energy terms in
DFT methods. These approaches differ in using either
only the electron density (<FONT COLOR="#0000FF">local methods</FONT>) or the electron 
density as well as its
gradients (<FONT COLOR="#0000FF">gradient corrected methods</FONT> or generalized gradient approximation, GGA). 
Aside from these "pure" 
DFT methods, another group of <FONT COLOR="#0000FF">hybrid functionals</FONT>
exists, in which mixtures of DFT and Hartree-Fock
exchange energies are used.<BR><BR><BR>

<B>1) Local methods</B><BR>
The only local exchange functional available in <I>Gaussian</I> is the Slater functional.
Combination with the local VWN correlation functional by Vosko, Wilk and Nusair
gives the <FONT COLOR="#0000FF">Local Density Approximation (LDA)</FONT> method.
For open shell systems, using unrestricted wavefunctions, this is also referred
to as the <FONT COLOR="#0000FF">Local Spin Density Approximation (LSDA)</FONT>.
This method is used in <I>Gaussian</I> with either the <FONT COLOR="#0000FF">LSDA</FONT>
or <FONT COLOR="#0000FF">SVWN</FONT> keyword. A sample input for the frequency calculation
for the methanol-1-yl radical using the SVWN functional and the 6-31G(d) basis set
is as follows:<BR><BR>

<TABLE BORDER=0>
<TR><TD>

<FONT COLOR="#0000FF">
<PRE>
#SVWN/6-31G(d) freq

SVWN/6-31G(d) freq methanol-1-yl radical

0 2
C1
O2  1  r2
H3  2  r3  1  a3
H4  1  r4  2  a4  3  d4
H5  1  r5  2  a5  4  d5

r2=1.35454381
r3=0.97675734
r4=1.09713107
r5=1.09208721
a3=108.95266528
a4=119.30335589
a5=113.0329959
d4=-26.58949552
d5=-149.77421707
</PRE>
</FONT>

<TD>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
<TD><IMG SRC="dft1_pict1.gif"></TD>
</TABLE><BR>

Please observe that the acrynom <FONT COLOR="#0000FF">VWN</FONT> is used to
indicate different functionals in different software packages. While in <I>Gaussian</I>
this keyword refers to functional III described in the VWN-paper
(S. J. Vosko, L. Wilk, M. Nusair, <I>Can. J. Phys.</I> <B>1980</B>, <I>58</I>, 1200), most other packages 
refer to functional V in the same paper. This latter functional can also be used
in <I>Gaussian</I> with the <FONT COLOR="#0000FF">VWN5</FONT> keyword.
<BR><BR><BR>


<B>2) Gradient corrected methods</B><BR>
The gradient-corrected exchange functionals available in <I>Gaussian</I> include
(given with their abbreviations in parenthesis):<BR><BR>

<UL>
	<LI>Becke88 (B)
	<LI>Perdew-Wang (PW91)
	<LI>Modified Perdew-Wang by Barone and Adamo (MPW)
	<LI>Gill96 (G96)
	<LI>Perdew-Burke-Ernzerhof (PBE)
</UL>

and the gradient-corrected correlation functionals are<BR><BR>

<UL>
    <LI>LYP by Lee, Yang, and Parr (LYP)
    <LI>Perdew-Wang (PW91)
    <LI>Perdew 86 (P86)
	<LI>Becke96 (B96)
	<LI>Perdew-Burke-Ernzerhof (PBE)
</UL>

In all cases, the names of these functionals refer to their respective authors and
the year of publication. All combinations of exchange and correlation functionals
are possible, the keywords being composed of the acronyms for the two functionals.
The frequently used <FONT COLOR="#0000FF">BLYP</FONT> method, for example, combines Becke's 1988 exchange 
functional with the correlation functional by Lee, Yang, and Parr. An input file for the
BLYP frequency calculation of the methanol-1-yl radical is:<BR><BR>

<TABLE BORDER=0>
<TR><TD>

<FONT COLOR="#0000FF">
<PRE>
#P BLYP/6-31G(d) freq

BLYP/6-31G(d) opt min methanol radical

0 2
C1
O2  1  r2
H3  2  r3  1  a3
H4  1  r4  2  a4  3  d4
H5  1  r5  2  a5  4  d5

r2=1.38575119
r3=0.98034945
r4=1.09658704
r5=1.09123991
a3=108.13230593
a4=118.45265645
a5=112.14316572
d4=-29.40173022
d5=-145.83450795
</PRE>
</FONT>

<TD>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
<TD><IMG SRC="dft1_pict1.gif"></TD>
</TABLE><BR>

Another frequently used GGA functional is <FONT COLOR="#0000FF">BP86</FONT> composed of the 
Becke 1988 exchange functional and the Perdew 86 correlation functional. The <FONT COLOR="#0000FF">PW91</FONT> 
functional combines exchange and correlation functionals developed by the same authors in 1991.
The keywords used in <I>Gaussian</I> for a particular GGA functional are combinations of
the acronyms for exchange and correlation functionals. Use of the PW91 exchange and correlation functionals
thus requires the keyword <FONT COLOR="#0000FF">PW91PW91</FONT>.<BR><BR><BR>


<B>3) Hybrid functionals</B><BR>
The basic idea behind the hybrid functionals is to mix exchange energies calculated
in an exact (Hartree-Fock-like) manner with those obtained from DFT methods in order to improve performance. 
Frequently used methods are:

<UL>
	<LI>Becke-Half-and-Half-LYP (<FONT COLOR="#0000FF">BHandHLYP</FONT>) uses a 1:1 mixture 
	of DFT and exact exchange energies:<BR>
	E<SUB>XC</SUB> = 0.5*E<SUB>X</SUB>(HF) + 0.5*E<SUB>X</SUB>(B88) + E<SUB>C</SUB>(LYP)<BR><BR>

	<LI>Becke-3-LYP (<FONT COLOR="#0000FF">B3LYP</FONT>) uses a different mixing scheme 
	involving three mixing parameters:<BR>
	E<SUB>XC</SUB> = 0.2*E<SUB>X</SUB>(HF) + 0.8*E<SUB>X</SUB>(LSDA) + 0.72*DE<SUB>X</SUB>(B88)
	+ 0.81*E<SUB>C</SUB>(LYP) + 0.19*E<SUB>C</SUB>(VWN)<BR>
	In this latter case, the B88 gradient correction to the local LSDA exchange energies
	carries its own scaling factor of 0.72. The three scaling factors have been derived
	through fitting the parameters to a set of thermochemical data (G1 set).<BR><BR>  
	
	<LI><FONT COLOR="#0000FF">PBE0</FONT> uses a 1:3 mixture of DFT and exact exchange energies:<BR>
	E<SUB>XC</SUB> = 0.25*E<SUB>X</SUB>(HF) + 0.75*E<SUB>X</SUB>(PBE) + E<SUB>C</SUB>(mPW91)<BR><BR>
	
	<LI><FONT COLOR="#0000FF">B98</FONT> (Becke98) is based on a 10-parameter equation scaling components of 
	exact exchange, GGA exchange and GGA correlation. All parameters have been optimized simultaneously
	to fit thermochemica data collected in the extended G2 data set:<BR>
	E<SUB>XC</SUB> = 0.2198*E<SUB>X</SUB>(HF) + E<SUB>X</SUB> + E<SUB>C</SUB><BR><BR>
</UL>  

The Becke-half-and-half-LYP method is used with the <FONT COLOR="#0000FF">BHandHLYP</FONT>
keyword, the very popular Becke-3-LYP method is used with the <FONT COLOR="#0000FF">B3LYP</FONT>
keyword, and the PBE0 method with the <FONT COLOR="#0000FF">PBE1PBE</FONT> keyword. 
A sample input file for the B3LYP frequency calculation on the methanol-1-yl radical is:<BR><BR>

<TABLE BORDER=0>
<TR><TD>

<FONT COLOR="#0000FF">
<PRE>
#P B3LYP/6-31G(d) freq

Becke-3-LYP/6-31G(d) opt min methanol radical

0 2
C1
O2  1  r2
H3  2  r3  1  a3
H4  1  r4  2  a4  3  d4
H5  1  r5  2  a5  4  d5

r2=1.37007444
r3=0.96903862
r4=1.08886325
r5=1.08381987
a3=108.87657926
a4=118.49962766
a5=112.61039767
d4=-29.19863769
d5=-146.73450089
</PRE>
</FONT>

<TD>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
<TD><IMG SRC="dft1_pict1.gif"></TD>
</TABLE><BR>

It is important to note that implementations of the <FONT COLOR="#0000FF">B3LYP</FONT> and
<FONT COLOR="#0000FF">BHLYP</FONT> functionals in different programs (<I>Gaussian</I>,
<I>Turbomole</I>, <I>Jaguar</I>, <I>Q-Chem</I>) vary somewhat. Other hybrid functionals available in <I>Gaussian</I> 
are: <FONT COLOR="#0000FF">B3P86</FONT> uses the P86 correlation functional instead of LYP, but retains the
three parameters derived for B3LYP; <FONT COLOR="#0000FF">B3PW91</FONT> uses the PW91 correlation functional 
instead of LYP, but retains the three parameters derived for B3LYP; <FONT COLOR="#0000FF">B1B96</FONT>, a one
parameter functional developed by Becke using the Becke 96 correlation functional; <FONT COLOR="#0000FF">MPW1PW91</FONT>
developed by Barone and Adamo using a modified version of the PW91 exchange functional in combination with
the original PW91 correlation functional and a mixing ratio of exact and DFT exchange of 0.25 : 0.75.<BR><BR><BR>


<B>4) User-defined models</B><BR>
Calculation of reaction and activation energies in either radical reactions or transition
metal mediated reactions often shows that the mixing ratio of HF- and DFT-exchange is not 
optimal for a given purpose. The definition of user-defined models tailored to a certain purpose
is therefore sometimes necessary. This can be achieved by first choosing gradient corrected
exchange and correlation functionals from the list of available choices and then specifying the
mixing ratios of the various exchange and correlation energy terms. For this latter step <I>Gaussian</I>
uses the general formula:<BR><BR>

E<SUB>XC</SUB> = P<SUB>2</SUB>E<SUB>X</SUB><SUP>HF</SUP> + 
				 P<SUB>1</SUB>(P<SUB>4</SUB>E<SUB>X</SUB><SUP>Slater</SUP> + 
				 P<SUB>3</SUB>dE<SUB>X</SUB><SUP>non-local</SUP>) +
				 P<SUB>6</SUB>E<SUB>C</SUB><SUP>local</SUP> +
				 P<SUB>5</SUB>dE<SUB>C</SUB><SUP>non-local</SUP>
				<BR><BR>

The values for the parameters P<SUB>1</SUB> - P<SUB>6</SUB> are provided through the IOP switches
IOP(5/45=xxxxyyyy), IOP(5/46=xxxxyyyy), and IOP(5/47=xxxxyyyy) with P<SUB>1</SUB> = xxxx/1000 from IOP(5/45)
etc. The use of this facility will be illustrated with the <FONT COLOR="#0000FF">MPW1K</FONT> functional by Truhlar 
and coworkers (B. J. Lynch, P. L. Fast, M. Harris, D. G. Truhlar, <I>J. Phys. Chem. A</I> <B>2000</B>, <I>104</I>, 4811)
developed to optimize reaction and activation energies of free radical reactions. This method is very similar to the
<FONT COLOR="#0000FF">MPW1PW91</FONT> hybrid functional, but uses a mixing ratio of exact and DFT exchange energy terms
of 0.428 : 0.572. An input file for the methanol-1-yl radical frequency calculation at the MPW1K/6-31G(d) level is:
<BR><BR>

<TABLE BORDER=0>
<TR><TD>

<FONT COLOR="#0000FF">
<PRE>
#P MPWPW91/6-31G(d) freq
 IOP(5/45=10000428) IOP(5/46=05720572) IOP(5/47=10001000)

MPW1K/6-31G(d) opt min methanol radical

0 2
C1
O2  1  r2
H3  2  r3  1  a3
H4  1  r4  2  a4  3  d4
H5  1  r5  2  a5  4  d5

r2=1.35355619
r3=0.95690342
r4=1.08170148
r5=1.07685321
a3=109.38001654
a4=118.56662303
a5=112.99211737
d4=-29.64928765
d5=-147.42512309
</PRE>
</FONT>

<TD>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
<TD><IMG SRC="dft1_pict1.gif"></TD>
</TABLE><BR>

The gradient corrected <FONT COLOR="#0000FF">MPWPW91</FONT> functional is chosen here as the basis of
the hybrid method and the amount of exact exchange is specified through parameter P<SUB>2</SUB>. The
composition of the functional is also described in the output file in a compact format:<BR><BR>

<FONT COLOR="#0000FF">
<PRE>
 IExCor= 908 DFT=T Ex=mPW+HF Corr=PW91 ScaHFX= 0.4280
 ScaDFX=  0.5720  0.5720  1.0000  1.0000
</PRE>
</FONT><BR>

The value given after <FONT COLOR="#0000FF">ScaHFX</FONT> corresponds to P<SUB>2</SUB> while the
four values listed after <FONT COLOR="#0000FF">ScaDFX</FONT> are P<SUB>3</SUB> - P<SUB>6</SUB>.
Please observe that theses lines are only printed when using the extended output option of <I>Gaussian</I>.
Before using this facility with a particular version of <I>Gaussian</I>, please make sure that
your IOP-directives are read correctly. In some versions of <I>Gaussian</I>, the options
P<SUB>1</SUB> - P<SUB>6</SUB> are set with IOP(3/76) - IOP(3/78) instead of IOP(5/45) - IOP(5/47).
In this latter case, the values of P1 - P6 are given in five-digit format. The keyword line
for the <FONT COLOR="#0000FF">PBE0</FONT> frequency calculation thus becomes:<BR><BR>

<FONT COLOR="#0000FF">
<PRE>
#P PBEPBE/6-31G(d) freq
 IOP(3/76=1000002500) IOP(3/77=0750007500) IOP(3/78=1000010000)
</PRE>
</FONT><BR><BR>

Absolute and relative CPU-times for DFT- and Hartree-Fock-calculations depend dramatically on the
size of the system under investigation, the computer hardware and the operating system
used. The following table contains CPU times (in seconds) for all frequency calculations on the
methanol-1-yl radical  described above with <I>Gaussian 03, Rev. B.03</I>. The platforms used are 
the CIP-room Pentium 4/2 GHz computers under LINUX. In all cases the frequency calculation has 
been performed on the structure optimized at the given theoretical level. The 6-31G(d) basis set 
has been used in all cases.<BR><BR>

<TABLE BORDER=2 FRAME=box>
	<TR><TH>&nbsp;method&nbsp;<TH>&nbsp;CPU (P4/2GHz)&nbsp;<BR>[sec]<TH>&nbsp;vib(1)&nbsp;<BR>[cm<SUP>-1</SUP>]<TH>&nbsp;vib(2)&nbsp;<BR>[cm<SUP>-1</SUP>]<TH>&nbsp;vib(3)&nbsp;<BR>[cm<SUP>-1</SUP>]
	<TR align=center><TD>USVWN/6-31G(d)<TD>31<TD>3690<TD>1455<TD>1036
	<TR align=center><TD>UBLYP/6-31G(d)<TD>69<TD>3599<TD>1463<TD>1042
	<TR align=center><TD>UB3LYP/6-31G(d)<TD>71<TD>3761<TD>1508<TD>1072
	<TR align=center><TD>&nbsp;UMPW1K/6-31G(d)&nbsp;<TD>73<TD>3950<TD>1552<TD>1102
	<TR align=center><TD>UHF/6-31G(d)<TD>11<TD>4123<TD>1627<TD>1156
	<TR align=center><TD>&nbsp;obsvd.&nbsp;<TD>-<TD>3650<TD>1459<TD>1056
</TABLE><BR><BR>

Despite all platform-dependend variations, it is clear that hybrid DFT calculations are similarly 
laborious as GGA calculations, while local DFT methods are somewhat and HF-calculations much cheaper.
In matching calculated (harmonic) gas phase vibrational frequencies with experimentally observed 
anharmonic values measured in a matrix (R. D. Johnson III, J. W. Hudjens, <I>J. Phys. Chem.</I>, <B>1996</B>, <I>100</I>, 19874), 
please remember that uniform scaling is often performed to improve correspondence
(see our <A HREF="../vib/vib1.html">earlier discussion</A> of this point). The values reported here are unscaled.
A general trend visible in this example is the increase of vibrational frequency wavenumbers with an increase in
the amount of Hartree-Fock exchange contributions (varying between 0 and 100% from the second entry to 
the bottom in Table 1).
<BR><BR>


<B>5) Further technical considerations</B><BR>
Evaluation of the exchange-correlation energies of all density functional methods implemented in 
<I>Gaussian</I> involves a grid-based numerical integration step. The computational effort required
for this step strongly depends on the selected grid size. The larger the number of integration
points per atom, the higher is the computational cost and the better the numerical accuracy of the
calculation. Several predefined grids are available in <I>Gaussian</I>, which can be used through the
keyword<BR><BR>

<FONT COLOR="#0000FF">int=(gridsize)</FONT> or <FONT COLOR="#0000FF">int=(Grid=gridsize)</FONT><BR><BR>

Alternatively, the grid size can also be specified with IOP settings, using either 
<FONT COLOR="#0000FF">IOP(5/44=gridsize)</FONT> or <FONT COLOR="#0000FF">IOP(3/75=gridsize)</FONT>,
depending on the version of <I>Gaussian</I>. The following are acceptable values for 
<FONT COLOR="#0000FF">gridsize</FONT>:<BR><BR>

<TABLE BORDER=2 FRAME=box>
	<TR><TH><FONT COLOR="#0000FF">gridsize</FONT><TH>&nbsp;corresponding&nbsp;<BR>IOP setting<TH>&nbsp;(radial shells *<BR> angular points) <TH>&nbsp;CPU [sec]&nbsp;<TH>E<SUB>tot</SUB><TH>frequencies<BR>(cm<SUP>-1</SUP>)
	<TR align=center><TD>&nbsp;CoarseGrid<TD>2<TD>(35*110), pruned<TD>33.8<TD>&nbsp;-115.0520127&nbsp;<TD>&nbsp;-110.9325   -0.0015   -0.0009   -0.0008   24.6825   59.6546
	<TR align=center><TD>SG1Grid<TD>1<TD>(50*194), pruned<TD>45.1<TD>&nbsp;-115.0520371&nbsp;<TD>&nbsp;-30.5802    0.0015    0.0015    0.0016   10.5877   29.2740
	<TR align=center><TD>finegrid<TD>4<TD>(75*302), pruned<TD>77.1<TD>&nbsp; -115.0520326&nbsp;<TD>&nbsp;-20.7294   -8.3913    0.0009    0.0009    0.0014   11.1426
	<TR align=center><TD>ultrafine<TD>5<TD>(99*590), pruned<TD>192.7<TD>&nbsp;-115.0520324&nbsp;<TD>&nbsp;-0.0013   -0.0013    0.0011    2.6708    4.0642   14.0308
	<TR align=center><TD>mmm,nnn<TD>mmmnnn<TD>(mmm*nnn), not pruned<TD> - <TD> - <TD> - 
</TABLE><BR><BR>

The CPU times and total energies listed here (in sec.) together with the grid specifications are 
those for the UB3LYP/6-31G(d) frequency calculation on the methanol radical mentioned before on 
the CIP room Pentium 4 LINUX PCs. It is clear from these results that neither the total electronic 
energy nor the low-frequency vibrations converge quickly with increasing grid size. Thus, for each 
application it must be decided, whether the substantial computational effort for a very high grid 
size is justified. It is also important to note that the energy variation with grid size is
significant enough that all calculations for stationary points on the same potential energy surface
must be performed with the same grid in order to be comparable!
<BR><BR>

In addition to the grid selection for integral evaluation using the <FONT COLOR="#0000FF">int=(gridsize)</FONT> keyword,
a particular grid can also be selected for the calculation of second derivatives using the 
<FONT COLOR="#0000FF">CPHF=gridsize</FONT> keyword. The available options for <FONT COLOR="#0000FF">gridsize</FONT> are
identical in both cases. If no explicit grid is specified through the <FONT COLOR="#0000FF">CPHF</FONT> keyword,
the following relations exist between the grids used for integral and second derivative calculations:<BR><BR>

<TABLE BORDER=2 FRAME=box>
	<TR><TH><FONT COLOR="#0000FF">gridsize</FONT> used for<BR>&nbsp;integral evaluation</FONT><TH>grid used for<BR>&nbsp;second derivatives
	<TR align=center><TD>CoarseGrid<TD>CoarseGrid
	<TR align=center><TD>SG1Grid<TD>CoarseGrid
	<TR align=center><TD>finegrid<TD>CoarseGrid
	<TR align=center><TD>ultrafine<TD>SG1Grid
	<TR align=center><TD>(mmm*nnn)<TD>(mmm*nnn) 
</TABLE><BR>

These combinations are usually appropriate for most systems. The default grid size for integral evaluation in 
the most recent versions of <I>Gaussian</I> is <FONT COLOR="#0000FF">finegrid</FONT>. Better grids are required
for kinetic isotope effect calculations, the optimization of stationary points on very flat potential
energy surfaces, and IRC-following on flat potential energy surfaces. Increasing the CPHF grid size over what
is specified per default through the integral grid selection is rarely helpful. Smaller grids can be quite 
useful to speed up geometry optimizations of large systems, especially when still far away from the next 
stationary point. 
<BR><BR>

<B>6) Treating open shell systems</B><BR>
For practical reasons the DFT methods also use a DFT "wavefunction" constructed as an antisymmetrized product
of one electron functions (now termed <FONT COLOR="#0000FF">Kohn-Sham orbitals</FONT>). As in
<A HREF="hf3.html">Hartree-Fock theory</A>,
electrons of unlike spin can either use the same spatial orbitals (restricted DFT methods) or different spatial
orbitals (unrestricted DFT methods). Specification of a restricted open shell wavefunction for the Becke3LYP 
hybrid functional requires the <FONT COLOR="#0000FF">ROB3LYP</FONT> keyword, while the unrestricted version is
specified using <FONT COLOR="#0000FF">UB3LYP</FONT>. If no explicit choice is made in the input file, open shell
systems are treated with the unrestricted approach by default. It should be noted that unrestricted
DFT methods (GGA or hybrid functionals alike) are much less affected by the phenomenon of spin contamination
than Hartree-Fock theory and also give much better predictions of ESR spectra of organic radicals. The 
UB3LYP/6-31G(d) calculation of the allyl radical is achieved with the following input file:<BR><BR>

<TABLE BORDER=0>
<TR><TD>

<FONT COLOR="#0000FF">
<PRE>
#UBecke3LYP/6-31G(d) scf=(tight)

UB3LYP/6-31G(d) ally radical (C2v)

0 2
H
C,1,r2
C,2,r3,1,a3
C,2,r3,1,a3,3,180.
H,3,r5,2,a5,1,0.
H,4,r5,2,a5,1,0.
H,3,r7,2,a7,1,180.
H,4,r7,2,a7,1,180.

r2=1.09054601
r3=1.38611149
r5=1.08492921
r7=1.08690606
a3=117.45043254
a5=121.64506508
a7=121.12827199

</PRE>
</FONT>

<TD>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
<TD><IMG SRC="hf3_pict1.gif"></TD>
</TABLE><BR>

Comparison of the expectation value of the &lt;S<SUP>2</SUP>&gt; operator calculated at the
UHF/6-31G(d) level (0.9729) with that obtained at UB3LYP/6-31G(d) (0.7818) shows that the spin 
contamination problem is much reduced with DFT methods. From the construction principle 
of the hybrid DFT methods it is clear that a larger HF-exchange component will also give 
rise to larger amounts of spin contamination. Using the allyl radical at the UB3LYP/6-31G(d) 
structure as an example, the &lt;S<SUP>2</SUP>&gt; value amounts to 0.7650 at the BLYP/6-31G(d) 
level and to 0.8228 at the BHandHLYP/6-31G(d) level. The precise values of the expectation 
value of the &lt;S<SUP>2</SUP>&gt; operator will also depend to some extend on the basis set 
used.<BR><BR>

Another important point to consider in DFT calculations concerns the <FONT COLOR="#0000FF">self interaction 
error</FONT> resulting from an artificial interaction of the electron density with itself. While the definition
of the exchange and Coulomb energies in Hartree-Fock theory leads to a perfect cancellation of these self
interaction terms, the cancellation is incomplete in DFT methods. As nicely explained by Koch and Holthausen
in their monograph on DFT methods, this can be easily demonstrated using the hydrogen atom. The exact energy
for this one-electron system is -0.50000 Hartree. As there is no second electron in the system, no correlation
energies have to be calculated and Hartree-Fock theory is able to provide the exact answer in the complete
basis set limit. Using a basis set considered "large" for molecular systems such as the cc-pVQZ basis set,
a value of -0.499946 Hartree is indeed obtained. Due to the parameterized exchange and correlation functionals,
however, much more negative values can be obtained in particular with hybrid DFT functionals. Using the
same basis set, the UB3LYP functional predicts a value of -0.502346 Hartree!!<BR><BR>

<hr>
<PRE>
<TT>last changes: 12.12.2006, HZ
questions & comments to: <A HREF="mailto:zipse@cup.uni-muenchen.de">zipse@cup.uni-muenchen.de</A>
</TT>
</PRE> 


</BODY>
</HTML>
