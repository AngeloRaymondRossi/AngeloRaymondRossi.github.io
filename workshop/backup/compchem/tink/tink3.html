<HTML>
<HEAD>
   <TITLE>searching confromational space</TITLE>
</HEAD>

<body bgcolor="#FFFFFF">
<BODY>

<CENTER><H2>Searching Conformational Space</H2></CENTER>
<HR>

<P>
In order to search the conformational space of larger systems, <FONT COLOR="#000FF">Tinker</FONT> offers
a number of different subprograms. The strategies that can be used for the exploration of conformational 
space can roughly be divided in those relying on (a) systematic searching conformational space or on 
(b) random search strategies.<BR><BR>

One of the options to search the conformational space of macromolecules systematically is the combination
of large torsional motion with local geometry optimization as implemented in the program 
<FONT COLOR="#000FF">scan</FONT>. The first argument accepted by the program is the principal file name
(which helps locate the xyz-coordinates file used for structural input). The second argument accepted
by the program decides over the selection of torsional angles in the search list. Automatic selection
is chosen with the argument 0. Other options for the second argument are 1 (selecting manual selection
of angles to rotate) or 2 (manual selection of angles to freeze). In case automatic selection of
dihedral angles is specified, the number of torsions is determined by the program and listed in the
output file. For each conformational minimum found in the search list, the program searches along a
given number of normal modes for new minima by taking a larger step in the direction (positive as well
as negative) along one normal mode, followed by geometry optimization to the next local minimum. The
number of search directions represents the third argument accepted by the program (default = 5). 
The list of conformational minima maintained by the program encompasses structures within a given
energy window. The size of this window can be given (in kcal/mol) as the fourth argument to the program.
The window size defaults to 100 kcal/mol. The local geometry optimization to a minimum energy structure
depends on a convergence criterion in the same way as already discussed for the different optimizers.
The convergence criterion is the fifth argument given to the program and defaults to 0.0001 kcal/mol/angstrom.
While a tigher convergence criterion will slow down the conformational search, a looser convergence
criterion will make it more difficult to match identical conformations obtained in two different local
searches. The following example builds the end-capped amino acid alanine (often termed the alanine dipeptide)
through an appropriate call to the <FONT COLOR="#000FF">protein</FONT> program (building up the peptide 
structure in file <I>testz1.xyz</I>) and searches the conformational spcace of this system with 
<FONT COLOR="#000FF">scan</FONT>. A shell script executing all of these steps (e.g. saved in file
<I>testz1.run</I>) is as follows:<BR><BR>

<FONT COLOR="#000FF">
protein < testz1.dat<BR>
scan testz1 0 5 100 0.0001<BR>
grep "Map" testz1.log | cat > tempo<BR>
sort tempo -nr -k 6,6n -o testz1.list<BR>
rm tempo<BR>
</FONT><BR>

This script file can be executed (after making it executable) in a straigh forward manner 
with:<BR><BR>

<FONT COLOR="#000FF">
./testz1.run >& testz1.log &<BR>
</FONT><BR>

The input file for <FONT COLOR="#000FF">protein</FONT> is as follows:<BR><BR>

<TABLE BORDER=0>
<TR><TD>
<FONT COLOR="#000FF">
testz1<BR>
testz1 ACE-ala-NME, alanine dipeptide<BR>
ACE<BR>
ala<BR>
NME<BR>
<BR>
n<BR>
</FONT><BR>
<TD>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<TD><IMG SRC="aladip.gif">
</TABLE><BR>

The keyword file for this example is also quite simple:<BR><BR>

<FONT COLOR="#000FF">
parameters&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    /usr/local/tinker/params/amber99<BR>
enforce-chirality<BR>
</FONT><BR>

The keyword <FONT COLOR="#000FF">enforce-chirality</FONT> checks that during conformational 
searches the absolute configuration of the system is maintained. The output generated by <FONT COLOR="#000FF">
scan</FONT> is as follows:<BR><BR>

<FONT COLOR="#000FF"><PRE>
Normal Mode Local Search          Minimum    4   

   Search Direction   1              Step   38              -17.2591
   Search Direction   2              Step    8              -20.4180
   Search Direction   3              Step   22              -16.0053 

   Potential Surface Map          Minimum   10              -16.0053
   .
   .
</PRE></FONT>

This part of the output file reflects the investigation of structures generated from minimum 4 by
searching along the first three search directions. The first two searches yield structures which 
are known already. The third search, converged after 22 geometry optimization steps, yields a new
conformational minimum, which at this point happens to be number 10 in the list of known 
conformational minima.<BR><BR>

After execution of the program <FONT COLOR="#000FF">scan</FONT> the working directory contains one 
new structure file (in xyz coordinates) for each conformation found during the conformational search, 
named <I>testz1.001</I>, <I>testz1.002</I> . . . What the remaining lines in the command file <I>testz1.run</I> 
do is analyze the output file <I>testz1.log</I> in order to find the energetically most favorable structure. 
This is achieved here by extracting all lines containing the string "Map" from output file <I>testz1.log</I>, 
writing these lines to the file <I>tempo</I>, then using the UNIX <FONT COLOR="#000FF">sort</FONT> 
program to sort the lines 
in file <I>tempo</I> in reverse numerical order (-nr) using the values in field number 6 (-k 6,6n), 
and writing the sorted list to a new file <I>testz1.list</I>. Finally, the file <I>tempo</I> ist deleted. 
For the current example <FONT COLOR="#000FF">scan</FONT> finds 28 distinct conformational minima. 
The fourth minimum found during the search with an energy of -22.65 kcal/mol turns out to be the 
most favorable one. The structure of this conformation as generated by <FONT COLOR="#000FF">ffe</FONT> 
is shown at the left side below.<BR><BR>

<TABLE BORDER=NONE>
<TR><TD>
<IMG SRC="tink3a.jpg">
<TD>
<IMG SRC="tink3c.jpg">
</TABLE></BR>

This conformation contains a hydrogen bond between the acetyl protecting group of the alanine
nitrogen atom and the N-H bond of the N-Me capping group of the alanine carboxylate terminus.
Since an overall seven-membered ring is formed (including the hydrogen atom) and the alanine
methyl group is positioned in a pseudo-equatorial position of the seven-membered ring, this
conformation is referred to as the "C<SUB>7</SUB><SUP>eq</SUP>" conformation of the dipeptide.
The second most favorable structure is the "C<SUB>5</SUB>" conformation shown at the right side
above with an energy of -21.75 kcal/mol.<BR><BR>

Even for moderately large systems an exhaustive search of conformational space quickly
becomes prohibitive. In order to limit the conformational searches performed with 
<FONT COLOR="#000FF">scan</FONT>, it is therefore often quite reasonable, to limit the
search to selected dihedral angles. Using the end-capped hexaalanine heptapeptide as an
example, an approximate structure for the alpha-helical conformation can be generated
easily with the following input file for <FONT COLOR="#000FF">protein</FONT>:<BR><BR>

<FONT COLOR="#000FF">
test1<BR>
test1 ACE-(ala)6-NME, alpha helix input<BR>
ACE<BR>
ala  -60.0  -60.0  180.0<BR>
ala  -60.0  -60.0  180.0<BR>
ala  -60.0  -60.0  180.0<BR>
ala  -60.0  -60.0  180.0<BR>
ala  -60.0  -60.0  180.0<BR>
ala  -60.0  -60.0  180.0<BR>
NME<BR>
<BR>                                                                                       
n<BR>
</FONT><BR>

Optimization of this structure with the <FONT COLOR="#000FF">newton</FONT> optimizer
can be performed in a straight forward manner as discussed before, ultimately yielding
(using the AMBER force field and the amber99 parameter set) an optimized local minimum 
with an energy of -17.6165 kcal/mol. The conformational space of this system can be explored
to a limited degree involving only the essential degrees of freedom of the N- and C-terminal
amino acid residues using the following input for <FONT COLOR="#000FF">scan</FONT>:<BR><BR>

<FONT COLOR="#000FF">
test1<BR> 
1<BR>
7 8<BR>
8 9<BR>
57 58<BR>
58 59<BR>
<BR>                                                                                           
4<BR>
100.0<BR>
0.0001<BR>
<BR>                                                                                          
</FONT>

In this particular case the input file contains the principal name of the system (here: <I>test1</I>),
the manual selection of dihedral angle parameters (1), and the definition of four bonds around which
rotation will be allowed (7/8, 8/9, 57/58, 58/59). Inspection of the molecular structure of this system
with <FONT COLOR="#000FF">ffe</FONT> shows, that these dihedral angles are the phi and psi angles of the
two terminal alanine residues in the system. After terminating the input of rotatable bonds
with one blank line, the number of dihedral angles to explore for each conformer found during the
search is set to 4, the energy window for all conformers is set to 100.0 kcal/mol, and the geometry
optimization convergence criterion is set to 0.0001 kcal/mol/angstrom. This limited conformational 
search proceeds in a rather short time to find 21 different conformers,
the best of which has an energy of -17.6931 kcal/mol. The seed structure obtained from initial geometry
optimization with <FONT COLOR="#000FF">newton</FONT> is found as the second best structure. Please
observe that the length of conformational searches also depends on the dihedral angles chosen as the
active parameters in the input file. The selection of dihedral angles in the middle of the peptide
sequence is, for example, an effective tool for searching a much larger conformational space than
selection of dihedral angles located at the end of the peptide sequence.<BR><BR>

When studying large, conformationally flexible systems, one is often primarily interested in the energetically
most favorable structure, the "global minimum". One method for searching for the global minimum
energy structure is the global search trajectory method "Sniffer" by Butler and Slaminka. The method
is available in the <FONT COLOR="#000FF">Tinker</FONT> suite in the subprogram 
<FONT COLOR="#000FF">sniffer</FONT>. The algorithm used in <FONT COLOR="#000FF">sniffer</FONT> attempts
to locate the global minimum of the system through a combination of molecular dynamics steps and
gradient optimization steps. As input the program accepts the principal file name of the systems
(which helps to locate the xyz-coordinate input file), the number of geometry perturbation steps to 
generate initial sets of trial structures (defaulting to 100 steps), the target energy of the global minimum 
(defaulting to 0.0 kcal/mol), the RMS optimization criterion for local geometry optimization
(defaulting to 1.0 kcal/mol/angstrom). Should the energy of the system fall below what is defined as target
energy, the conformational search will be terminated (regardless of the value of the current gradient).
This requires the user to play with the target energy in order to find meaningful lower bounds.<BR><BR>

The success of <FONT COLOR="#000FF">sniffer</FONT> in locating the global minimum also depends on 
the input structure used. This can be demonstrated using again the alanine dipeptide example used
before. Generating this system with all psi, phi, omega angles set to 180.0 degrees (linear peptide
chain) with the following input file to <FONT COLOR="#000FF">protein</FONT>:<BR><BR>

<TABLE BORDER=0>
<TR><TD>
<FONT COLOR="#000FF">
testz1<BR>
testz1 ACE-ala-NME<BR>
ACE<BR>
ala 180.0 180.0 180.0<BR>
NME<BR>
<BR>
n<BR>
</FONT><BR>
<TD>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<TD><IMG SRC="aladip.gif">
</TABLE><BR>

and handing the resulting xyz-coordinates file <I>testz1.xyz</I> to <FONT COLOR="#000FF">sniffer</FONT>
with:<BR><BR>

<FONT COLOR="#000FF">
sniffer testz1  100 -25.0 1.0<BR>
</FONT><BR>

locates the C<SUB>5</SUB> conformation of the alanine dipeptide at -21.74 kcal/mol within 2471 iterations
as the supposedly global minimum. From the conformational search performed with <FONT COLOR="#000FF">scan</FONT>
it is clear, that this is indeed one of the energetically most favorable conformations of this system,
but not the global minimum. This is not so much a consequence of the number of trial structures
(10, 100, 200, or 500 trial structures yielding the same final result), but the linear peptide conformation 
used as the starting structure. A non-linear peptide chain can be generated with:<BR><BR>

<FONT COLOR="#000FF">
testz1<BR>
testz1 ACE-ala-NME, gauche<BR>
ACE<BR>
ala 180.0 60.0 180.0<BR>
NME<BR>
<BR>
n<BR>
</FONT><BR>

and processed with <FONT COLOR="#000FF">sniffer</FONT> as before. This time the C<SUB>7</SUB><SUP>eq</SUP>
minimum at -22.64 kcal/mol is indeed located within some 2154 iterations as the global minimum. While this
sensitivity of the algorithm on the initial trial structure is somewhat unfavorable, the true strength of the
<FONT COLOR="#000FF">sniffer</FONT> algorithm is its speed. The last (successfull) run to locate the global
minimum takes only 1.56 CPU sec., while the full conformational search with <FONT COLOR="#000FF">scan</FONT> 
requires 37.60 sec. This difference is, of course, bound to increase with increasing system size.<BR><BR>

<HR>
<PRE>
<TT>last changes: 03.11.2004, HZ
questions & comments to: <A HREF="mailto:zipse@cup.uni-muenchen.de">zipse@cup.uni-muenchen.de</A>
</TT>
</PRE> 




</BODY>
</HTML>


